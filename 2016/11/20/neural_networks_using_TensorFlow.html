<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>Algate's Blog|ä½¿ç”¨ TensorFlow å®ç°ç¥ç»ç½‘ç»œ</title>
    <meta name="description" content="ä»‹ç»">
    <meta name="author" content="algate">
    <link rel="alternate" type="application/rss+xml" title="Algate's Blog" href="http://localhost:4000/feed.xml">
    <link href="/assets/icon/favicon.ico" rel="bookmark" type="image/x-icon" />
    <link href="/assets/icon/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="/assets/icon/favicon.svg" rel="shortcut icon" type="image/x-icon" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <script type="text/javascript" src="/assets/js/jquery-1.11.3.min.js"></script>
    
    <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?617bf75bfd954382202927d87bf48f13";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <script type="text/javascript">
    window.google = {
        kEI: "3TLKTfD9DsmxcNrP7aIG",
        kEXPI: "17259,18167,28505,28555,29685,29795,29813,29957,30035,30107,30152,30205",
        kCSI: {
            e: "17259,18167,28505,28555,29685,29795,29813,29957,30035,30107,30152,30205",
            ei: "3TLKTfD9DsmxcNrP7aIG",
            expi: "17259,18167,28505,28555,29685,29795,29813,29957,30035,30107,30152,30205"
        },
        authuser: 0,
        ml: function() {},
        kHL: "zh-CN",
        time: function() {
            return (new Date).getTime()
        },
        log: function(c, d, b) {
            var a = new Image,
                e = google,
                g = e.lc,
                f = e.li;
            a.onerror = (a.onload = (a.onabort = function() {
                delete g[f]
            }));
            g[f] = a;
            b = b || "/gen_204?atyp=i&ct=" + c + "&cad=" + d + "&zx=" + google.time();
            a.src = b;
            e.li = f + 1
        },
        lc: [],
        li: 0,
        Toolbelt: {}
    };
    </script>
</head>

<body class="nav-fixed-top">
    <header class="header" style="z-index: 3;background: rgba(0,155,219,0.8)">
    <div class="container">
        <h1 class="logo"><a href="javascript:;"  style="font-size: 20px;color:#fff;">Algate's Blog</a></h1>
        <div class="sitenav">
            <ul>
                <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-8"><a href="/">é¦–é¡µ</a></li>
                
                <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10">
                    
                    <a href="/archive" title="archive">
                        æ‰€æœ‰æ–‡ç« 
                    </a>
                    
                    
                </li>
                
                <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10">
                    
                    <a href="/tags" title="tags">
                        åˆ†ç±»æ ‡ç­¾
                    </a>
                    
                    
                </li>
                
                <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10">
                    
                    <a href="/notes" title="notes">
                        æ—¥è®°
                    </a>
                    
                    
                </li>
                
                <li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10">
                    
                    <a href="/about" onclick="_hmt.push(['_trackEvent', 'algate', 'click', 'resume'])" title="about">
                        å…³äºæˆ‘çš„
                    </a>
                    
                    
                </li>
                
            </ul>
        </div>
        <div style="color:#8fe620;float:right;">æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡</div>
        <span class="sitenav-on"><i class="fa" style="color:#fff;">î˜…</i></span>
        <span class="sitenav-mask"></span>
    </div>
</header>
<style type="text/css">
    .hdfocus {
        height: 300px;
        color: #fff;
        background-color: #33383C;
        background-repeat: no-repeat;
        background-position: 50% 50%;
        background-size: cover;
        text-align: center;
    }
</style>
<div class="focus-slider flexslider">
    <canvas id="canvas" style="position: fixed;z-index: 0;top:0;"></canvas>
</div>
    <section class="container">
        <div class="excerpts-wrapper" style="margin-top:0;">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <h1 class="post-title">ä½¿ç”¨ TensorFlow å®ç°ç¥ç»ç½‘ç»œ</h1>
        <div class="post-meta">
            <img src="/assets/images/calendar.png" width="20px" />
            <time datetime="2016-11-20 00:00:00 +0800" itemprop="datePublished" class="post-meta__date date">2016-11-20</time>
            <span id="busuanzi_container_page_pv">
              æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡
            </span>
            </p>
        </div>
    </header>
    <section class="post">
        <h2 id="ä»‹ç»">ä»‹ç»</h2>

<p>ã€€ã€€ä¸€ç›´å…³æ³¨ <code class="highlighter-rouge">æ•°æ®ç§‘å­¦</code> ã€ <code class="highlighter-rouge">æœºå™¨å­¦ä¹ </code> çš„åŒå­¦ï¼Œä¸€å®šä¼šç»å¸¸çœ‹åˆ°æˆ–å¬åˆ°å…³äº <code class="highlighter-rouge">æ·±åº¦å­¦ä¹ </code> å’Œ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> ç›¸å…³ä¿¡æ¯ã€‚å¦‚æœä½ å¯¹ <code class="highlighter-rouge">æ·±åº¦å­¦ä¹ </code> æ„Ÿå…´è¶£ï¼Œä½†å´è¿˜æ²¡æœ‰å®é™…åŠ¨æ‰‹æ“ä½œè¿‡ï¼Œä½ å¯ä»¥ä»è¿™é‡Œå¾—åˆ°å®è·µã€‚</p>

<p>ã€€ã€€åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»‹ç» <code class="highlighter-rouge">TensorFlow</code> ,Â å¸®ä½ äº†è§£ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> çš„å®é™…ä½œç”¨ï¼Œå¹¶ä½¿ç”¨ <code class="highlighter-rouge">TensorFlow</code> æ¥è§£å†³ç°å®ç”Ÿæ´»ä¸­çš„é—®é¢˜ã€‚Â è¯»è¿™ç¯‡æ–‡ç« å‰ï¼Œéœ€è¦çŸ¥é“ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> çš„åŸºç¡€çŸ¥è¯†å’Œä¸€äº›ç†Ÿæ‚‰ç¼–ç¨‹ç†å¿µï¼Œæ–‡ç« ä¸­çš„ä»£ç æ˜¯ä½¿ç”¨ <code class="highlighter-rouge">Pyhton</code> ç¼–å†™çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦äº†è§£ä¸€äº› <code class="highlighter-rouge">Python</code> çš„åŸºæœ¬è¯­æ³•ï¼Œæ‰èƒ½æ›´æœ‰åˆ©å¯¹äºæ–‡ç« çš„ç†è§£ã€‚</p>

<div align="center">
	<img src="/images/posts/tfimg/logo.jpg" height="300" width="500" />  
</div>

<h3 id="ç›®å½•">ç›®å½•</h3>

<ul>
  <li><a href="#When-to-apply-neural-net">ä»€ä¹ˆæ—¶å€™åº”ç”¨ç¥ç»ç½‘ç»œï¼Ÿ</a></li>
  <li><a href="#solve-problems">é€šå¸¸ç¥ç»ç½‘ç»œèƒ½è§£å†³çš„é—®é¢˜</a></li>
  <li><a href="#popular-libraries">äº†è§£å›¾åƒæ•°æ®å’Œä¸»æµçš„åº“æ¥è§£å†³é—®é¢˜</a></li>
  <li><a href="#What-is-TensorFlow">ä»€ä¹ˆæ˜¯ TensorFlowï¼Ÿ</a></li>
  <li><a href="#A-typical-flow">TensorFlowÂ ä¸€ä¸ªÂ å…¸å‹Â çš„Â â€œÂ æµÂ â€</a></li>
  <li><a href="#MLP">åœ¨ TensorFlow ä¸­å®ç° MLP</a></li>
  <li><a href="#Limitations-of-TensorFlow">TensorFlow çš„é™åˆ¶</a></li>
  <li><a href="#vs-libraries">TensorFlow ä¸å…¶ä»–åº“</a></li>
  <li><a href="#Where-to-go-from-here">ä»è¿™é‡Œå»å“ªé‡Œï¼Ÿ</a></li>
</ul>

<h3 id="ä»€ä¹ˆæ—¶å€™ç”¨ç¥ç»ç½‘ç»œ"><a name="When-to-apply-neural-net"></a>ä»€ä¹ˆæ—¶å€™ç”¨ç¥ç»ç½‘ç»œï¼Ÿ</h3>

<p>ã€€ã€€<code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> å·²ç»åœ¨ç›¸å½“ä¸€æ®µæ—¶é—´æˆä¸ºæœºå™¨å­¦ä¹ ä¸­çš„ç„¦ç‚¹ã€‚Â å¯¹äº <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> å’Œ <code class="highlighter-rouge">æ·±åº¦å­¦ä¹ </code> ä¸Šè¿™é‡Œæœ‰æ›´è¯¦ç»†çš„è§£é‡ŠÂ <a href="https://www.analyticsvidhya.com/blog/2016/08/evolution-core-concepts-deep-learning-neural-networks/">ç‚¹å‡»é˜…è¯»</a>Â ã€‚Â å…¶ â€œæ›´æ·±â€ çš„åŠŸèƒ½åœ¨è®¸å¤šé¢†åŸŸéƒ½æœ‰å–å¾—å·¨å¤§çš„çªç ´ï¼Œå¦‚å›¾åƒè¯†åˆ«ï¼Œè¯­éŸ³å’Œè‡ªç„¶è¯­è¨€å¤„ç†ç­‰ã€‚</p>

<p>ã€€ã€€ä¸»è¦çš„é—®é¢˜åœ¨äºå¦‚ä½•ç”¨å¥½ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> ï¼Ÿç°åœ¨ï¼Œæ¯å¤©éƒ½ä¼šæœ‰è®¸å¤šæ–°å‘ç°ï¼Œè¿™ä¸ªé¢†åŸŸå°±åƒä¸€ä¸ªé‡‘çŸ¿ï¼Œä¸ºäº†æˆä¸ºè¿™ä¸ª â€œæ·˜é‡‘çƒ­â€ çš„ä¸€éƒ¨åˆ†ï¼Œå¿…é¡»è®°ä½å‡ ä»¶äº‹ï¼š</p>

<ul>
  <li>
    <p><strong>é¦–å…ˆï¼Œ<code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> éœ€è¦æœ‰æ˜ç¡®å’Œç¿”å®çš„æ•°æ®ï¼ˆä¸»è¦æ˜¯å¤§æ•°æ®ï¼‰è®­ç»ƒ</strong>ï¼ŒÂ è¯•ç€æƒ³è±¡ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> ä½œä¸ºä¸€ä¸ªå­©å­ï¼Œå®ƒä¸€å¼€å§‹ä¼šè§‚å¯Ÿå®ƒçˆ¶æ¯èµ°è·¯ï¼Œç„¶åå®ƒè¯•å›¾è‡ªå·±èµ°ï¼Œæ¯ä¸€æ­¥å°±åƒå­¦ä¹ æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡ã€‚Â å®ƒå¯èƒ½ä¼šå¤±è´¥å‡ æ¬¡ï¼Œä½†ç»è¿‡å‡ æ¬¡å¤±è´¥çš„å°è¯•ï¼Œå®ƒå°†ä¼šå¦‚ä½•èµ°è·¯ã€‚æ‰€ä»¥éœ€è¦ä¸ºå­©å­æä¾›æ›´å¤šçš„æœºä¼šï¼Œå¦‚æœä¸è®©å®ƒèµ°ï¼Œå®ƒå¯èƒ½æ°¸è¿œä¸ä¼šå­¦ä¹ å¦‚ä½•èµ°è·¯ã€‚</p>
  </li>
  <li>
    <p><strong>ä¸€äº›äººä¼šåˆ©ç”¨ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> è§£å†³å¤æ‚çš„é—®é¢˜ï¼Œå¦‚å›¾åƒå¤„ç†ï¼Œ</strong> Â <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> å±äºä¸€ç±»ä»£è¡¨å­¦ä¹ çš„ç®—æ³•ï¼Œè¿™äº›ç®—æ³•å¯ä»¥æŠŠå¤æ‚çš„é—®é¢˜åˆ†è§£ä¸ºç®€å•çš„å½¢å¼ï¼Œä½¿ä»–ä»¬æˆä¸ºå¯ä»¥ç†è§£çš„ï¼ˆæˆ–Â â€œå¯è¡¨ç¤ºâ€ï¼‰ï¼Œå°±åƒåå’½é£Ÿç‰©ä¹‹å‰çš„å’€åš¼ï¼Œè®©æˆ‘ä»¬æ›´å®¹æ˜“å¸æ”¶å’Œæ¶ˆåŒ–ã€‚è¿™ä¸ªåˆ†è§£çš„è¿‡ç¨‹å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„ç®—æ³•æ¥å®ç°ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å®ç°è¿‡ç¨‹å°†ä¼šå¾ˆå›°éš¾ã€‚</p>
  </li>
  <li>
    <p><strong>é€‰æ‹©é€‚å½“ç±»å‹çš„ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> ï¼Œæ¥è§£å†³é—®é¢˜ï¼Œ</strong> Â æ¯ä¸ªé—®é¢˜çš„å¤æ‚æƒ…å†µéƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ•°æ®å†³å®šä½ è§£å†³é—®é¢˜çš„æ–¹å¼ã€‚Â ä¾‹å¦‚ï¼Œå¦‚æœé—®é¢˜æ˜¯åºåˆ—ç”Ÿæˆçš„é—®é¢˜ï¼Œ<code class="highlighter-rouge">é€’å½’ç¥ç»ç½‘ç»œ</code> æ›´åˆé€‚ã€‚å¦‚æœå®ƒæ˜¯å›¾åƒç›¸å…³çš„é—®é¢˜ï¼Œæƒ³æ›´å¥½åœ°è§£å†³å¯ä»¥é‡‡å– <code class="highlighter-rouge">å·ç§¯ç¥ç»ç½‘ç»œ</code>ã€‚</p>
  </li>
  <li>
    <p><strong>æœ€åæœ€é‡è¦çš„å°±æ˜¯ <code class="highlighter-rouge">ç¡¬ä»¶</code> è¦æ±‚äº†ï¼Œç¡¬ä»¶æ˜¯è¿è¡Œ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> æ¨¡å‹çš„å…³é”®ã€‚</strong>Â ç¥ç»ç½‘è¢«Â â€œå‘ç°â€Â å¾ˆä¹…ä»¥å‰ï¼Œä»–ä»¬åœ¨è¿‘å¹´æ¥å¾—åˆ°æ¨å´‡çš„ä¸»è¦çš„åŸå› å°±æ˜¯è®¡ç®—èµ„æºæ›´å¥½ï¼Œèƒ½æ›´å¤§å‘æŒ¥å®ƒçš„å…‰èŠ’ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> è§£å†³è¿™äº›ç°å®ç”Ÿæ´»ä¸­çš„é—®é¢˜ï¼Œé‚£ä¹ˆä½ å¾—å‡†å¤‡è´­ä¹°ä¸€äº›é«˜ç«¯çš„ç¡¬ä»¶äº†ğŸ˜†ï¼</p>
  </li>
</ul>

<h3 id="é€šå¸¸ç¥ç»ç½‘ç»œè§£å†³çš„é—®é¢˜"><a name="solve-problems"></a>é€šå¸¸ç¥ç»ç½‘ç»œè§£å†³çš„é—®é¢˜</h3>

<p>ã€€ã€€ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ç®—æ³•ã€‚Â å› æ­¤ï¼Œä½œä¸ºæ¯ä¸ª ML ç®—æ³•éƒ½éµå¾ª æ•°æ®é¢„å¤„ç† ã€æ¨¡å‹å»ºç«‹ å’Œ æ¨¡å‹è¯„ä¼° çš„å·¥ä½œæµæµç¨‹ã€‚ä¸ºäº†ç®€æ˜èµ·è§ï¼Œä¸‹é¢åˆ—å‡ºäº†å¦‚ä½•å¤„ç† <code class="highlighter-rouge">ç¥ç»ç½‘ç»œ</code> é—®é¢˜çš„ TODO åˆ—è¡¨ã€‚</p>

<ul>
  <li>æ£€æŸ¥å®ƒæ˜¯å¦ä¸º ç¥ç»ç½‘ç»œ ï¼ŒæŠŠå®ƒçœ‹æˆä¸€ä¸ªä¼ ç»Ÿçš„ç®—æ³•é—®é¢˜</li>
  <li>åšä¸€ä¸ªè°ƒæŸ¥ï¼Œå“ªä¸ª ç¥ç»ç½‘ç»œ æ¡†æ¶æœ€é€‚åˆè§£å†³è¿™ä¸ªé—®é¢˜</li>
  <li>å®šä¹‰ ç¥ç»ç½‘ç»œ æ¡†æ¶ï¼Œé€šè¿‡å®ƒé€‰æ‹©å¯¹åº”çš„ ç¼–ç¨‹è¯­è¨€ å’Œ åº“</li>
  <li>å°†æ•°æ®è½¬æ¢ä¸ºæ­£ç¡®çš„æ ¼å¼å¹¶åˆ†æ‰¹åˆ†å‰²</li>
  <li>æ ¹æ®æ‚¨çš„éœ€è¦é¢„å¤„ç†æ•°æ®</li>
  <li>å¢å¼ºæ•°æ®ä»¥å¢åŠ å¤§å°å¹¶åˆ¶ä½œæ›´å¥½çš„è®­ç»ƒæ¨¡å‹</li>
  <li>æ‰¹æ¬¡ä¾›ç»™åˆ° ç¥ç»ç½‘ç»œ</li>
  <li>è®­ç»ƒå’Œç›‘æµ‹ï¼ŒåŸ¹è®­å’ŒéªŒè¯æ•°æ®é›†çš„å˜åŒ–</li>
  <li>æµ‹è¯•ä½ çš„æ¨¡å‹ï¼Œå¹¶ä¿å­˜ä»¥å¤‡å°†æ¥ä½¿ç”¨</li>
</ul>

<p>ã€€ã€€æœ¬æ–‡å°†ä¸“æ³¨äºå›¾åƒæ•°æ®ï¼Œæˆ‘ä»¬ä» TensorFlow å…¥æ‰‹ã€‚</p>

<h3 id="äº†è§£å›¾åƒæ•°æ®å’Œä¸»æµçš„åº“æ¥è§£å†³é—®é¢˜"><a name="popular-libraries"></a>äº†è§£å›¾åƒæ•°æ®å’Œä¸»æµçš„åº“æ¥è§£å†³é—®é¢˜</h3>

<p>ã€€ã€€å›¾åƒå¤§å¤šæ’åˆ—ä¸º 3-D é˜µåˆ—ï¼Œå…·ä½“æŒ‡ é«˜åº¦ã€å®½åº¦ å’Œ é¢œè‰²é€šé“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ç”µè„‘æˆªå±ï¼Œå®ƒå°†é¦–å…ˆè½¬æ¢æˆä¸€ä¸ª 3-D æ•°ç»„ï¼Œç„¶åå‹ç¼©å®ƒä¸º â€˜.jpegâ€™ æˆ– â€˜.pngâ€™ æ–‡ä»¶æ ¼å¼ã€‚</p>

<p>ã€€ã€€è™½ç„¶è¿™äº›å›¾åƒå¯¹äºäººç±»æ¥è¯´å¾ˆå®¹æ˜“ç†è§£ï¼Œä½†è®¡ç®—æœºå¾ˆéš¾ç†è§£å®ƒä»¬ã€‚Â è¿™ç§ç°è±¡ç§°ä¸ºâ€œè¯­ä¹‰ç©ºéš™â€ã€‚æˆ‘ä»¬çš„å¤§è„‘å¯ä»¥çœ‹çœ‹å›¾åƒï¼Œå¹¶åœ¨å‡ ç§’é’Ÿå†…è¯»æ‡‚å®Œæ•´çš„å›¾ç‰‡ã€‚ä½†è®¡ç®—æœºä¼šå°†å›¾åƒçœ‹ä½œä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œé—®é¢˜æ¥äº†ï¼Œå®ƒæƒ³çŸ¥é“è¿™æ˜¯ä¸€å¼ ä»€ä¹ˆæ ·çš„å›¾åƒï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ ·æŠŠå›¾åƒè§£é‡Šç»™æœºå™¨å®ƒæ‰èƒ½è¯»æ‡‚ï¼Ÿ</p>

<p>ã€€ã€€åœ¨æ—©æœŸï¼Œäººä»¬è¯•å›¾å°†å›¾åƒåˆ†è§£ä¸ºæœºå™¨çš„ â€œå¯ç†è§£â€ æ ¼å¼ï¼Œå¦‚â€œæ¨¡æ¿â€ã€‚ä¾‹å¦‚ï¼Œé¢éƒ¨æ€»æ˜¯å…·æœ‰åœ¨æ¯ä¸ªäººä¸­æœ‰æ‰€ä¿ç•™çš„ç‰¹å®šç»“æ„ï¼Œä¾‹å¦‚çœ¼ç›ï¼Œé¼»å­æˆ–æˆ‘ä»¬çš„è„¸çš„å½¢çŠ¶ã€‚Â ä½†æ˜¯è¿™ç§æ–¹æ³•å°†æ˜¯æœ‰ç¼ºé™·çš„ï¼Œå› ä¸ºå½“è¦è¯†åˆ«çš„å¯¹è±¡çš„æ•°é‡å°†å¢åŠ åˆ°ä¸€å®šé‡çº§æ—¶ï¼Œâ€œæ¨¡æ¿â€ å°†ä¸æˆç«‹ã€‚</p>

<p>ã€€ã€€2012å¹´ä¸€ä¸ªæ·±å±‚ç¥ç»ç½‘ç»œæ¶æ„èµ¢å¾—äº† ImageNet çš„æŒ‘æˆ˜ï¼Œä»è‡ªç„¶åœºæ™¯ä¸­è¯†åˆ«å¯¹è±¡ï¼Œå®ƒåœ¨å³å°†åˆ°æ¥çš„ ImageNet æŒ‘æˆ˜ä¸­ç»§ç»­ç»Ÿæ²»å…¶ä¸»æƒï¼Œä»è€Œè¯æ˜äº†è§£å†³å›¾åƒé—®é¢˜çš„æœ‰ç”¨æ€§ã€‚
äººä»¬é€šå¸¸ä½¿ç”¨å“ªäº› åº“ / è¯­è¨€ æ¥è§£å†³å›¾åƒè¯†åˆ«é—®é¢˜ï¼Ÿ<a href="https://www.analyticsvidhya.com/blog/2016/08/deep-learning-path/">æœ€è¿‘çš„ä¸€æ¬¡è°ƒæŸ¥</a>ä¸­ï¼Œæœ€æµè¡Œçš„æ·±åº¦å­¦ä¹ åº“ï¼Œæ”¯æŒçš„æœ€å‹å¥½çš„è¯­è¨€æœ‰ Python ï¼Œå…¶æ¬¡æ˜¯ Lua ï¼Œå¯¹ Java å’Œ Matlab æ”¯æŒçš„ä¹Ÿæœ‰ã€‚æœ€æµè¡Œçš„åº“ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>

<ul>
  <li><a href="http://caffe.berkeleyvision.org/">Caffe</a></li>
  <li><a href="http://deeplearning4j.org/">DeepLearning4j</a></li>
  <li><a href="https://www.tensorflow.org/">TensorFlow</a></li>
  <li><a href="http://www.deeplearning.net/software/theano">Theano</a></li>
  <li><a href="http://torch.ch/">Torch</a></li>
</ul>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬äº†è§£äº†å›¾åƒçš„å­˜å‚¨æ–¹å¼ä»¥åŠä½¿ç”¨çš„å¸¸ç”¨åº“ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code class="highlighter-rouge">TensorFlow</code> æä¾›çš„åŠŸèƒ½ã€‚</p>

<h3 id="ä»€ä¹ˆæ˜¯-tensorflow-"><a name="What-is-TensorFlow"></a>ä»€ä¹ˆæ˜¯ TensorFlow ï¼Ÿ</h3>

<p>è®©æˆ‘ä»¬ä»å®˜æ–¹å®šä¹‰å¼€å§‹.</p>

<p>ã€€ã€€â€œ<code class="highlighter-rouge">TensorFlow</code> æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶åº“ï¼Œç”¨äºä½¿ç”¨æ•°æ®æµå›¾è¿›è¡Œæ•°å€¼è®¡ç®—ã€‚å›¾ä¸­çš„èŠ‚ç‚¹è¡¨ç¤ºæ•°å­¦è¿ç®—ï¼Œè€Œå›¾è¾¹è¡¨ç¤ºåœ¨å®ƒä»¬ä¹‹é—´ä¼ é€’çš„å¤šç»´æ•°æ®é˜µåˆ—ï¼ˆä¹Ÿç§°ä¸ºå¼ é‡ï¼‰ã€‚Â çµæ´»çš„æ¶æ„å…è®¸æ‚¨ä½¿ç”¨å•ä¸€ API å°†è®¡ç®—éƒ¨ç½²åˆ°æ¡Œé¢ã€æœåŠ¡å™¨æˆ–ç§»åŠ¨è®¾å¤‡ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªçš„ CPU æˆ– GPU ä¸­ã€‚</p>

<p><img src="http://www.tensorfly.cn/images/tensors_flowing.gif" alt="" /></p>

<p>ã€€ã€€å¦‚æœæ„Ÿè§‰è¿™å¬èµ·æ¥å¤ªé«˜å¤§ä¸Šï¼Œä¸è¦æ‹…å¿ƒã€‚è¿™é‡Œæœ‰æˆ‘ç®€å•çš„å®šä¹‰ï¼Œ<code class="highlighter-rouge">TensorFlow</code> çœ‹èµ·æ¥æ²¡ä»€ä¹ˆï¼Œåªæ˜¯ numpy æœ‰äº›éš¾ä»¥ç†è§£ã€‚å¦‚æœä½ ä»¥å‰ä½¿ç”¨è¿‡ numpy ï¼Œç†è§£ TensorFlow å°†æ˜¯æ‰‹åˆ°æ“’æ¥ï¼Â numpy å’Œ TensorFlow ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ TensorFlow éµå¾ªæƒ°æ€§ç¼–ç¨‹èŒƒä¾‹ã€‚Â TensorFlow çš„æ“ä½œåŸºæœ¬ä¸Šéƒ½æ˜¯å¯¹ session çš„æ“ä½œï¼Œå®ƒé¦–å…ˆæ„å»ºä¸€ä¸ªæ‰€æœ‰æ“ä½œçš„å›¾å½¢ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ session æ—¶ TensorFlow å°±å¼€å§‹å·¥ä½œäº†ã€‚å®ƒé€šè¿‡å°†å†…éƒ¨æ•°æ®è¡¨ç¤ºè½¬æ¢ä¸ºå¼ é‡ï¼ˆTensorï¼Œä¹Ÿç§°ä¸ºå¤šç»´æ•°ç»„ï¼‰æ¥æ„å»ºä¸ºå¯æ‰©å±•çš„ã€‚Â æ„å»ºè®¡ç®—å›¾å¯ä»¥è¢«è®¤ä¸ºæ˜¯ TensorFlow çš„ä¸»è¦æˆåˆ†ã€‚æƒ³æ›´å¤šåœ°äº†è§£ä¸€ä¸ªè®¡ç®—å›¾å½¢çš„æ•°å­¦ç»“æ„ï¼Œå¯ä»¥é˜…è¯»Â <a href="http://colah.github.io/posts/2015-08-Backprop/">è¿™ç¯‡æ–‡ç« </a>Â ã€‚</p>

<p>ã€€ã€€é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¾ˆå®¹æ˜“å°† TensorFlow åˆ†ç±»ä¸ºç¥ç»ç½‘ç»œåº“ï¼Œä½†å®ƒä¸ä»…ä»…æ˜¯å¦‚æ­¤ã€‚å®ƒè¢«è®¾è®¡æˆä¸€ä¸ªå¼ºå¤§çš„ç¥ç»ç½‘ç»œåº“ï¼Œ ä½†å®ƒæœ‰èƒ½åŠ›åšæ›´å¤šçš„äº‹æƒ…ã€‚å¯ä»¥æ„å»ºå®ƒä¸ºå…¶ä»–æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå¦‚ å†³ç­–æ ‘ æˆ– k-æœ€è¿‘é‚»ï¼Œä½ å¯ä»¥ä»å­—é¢ä¸Šç†è§£ï¼Œä½ å¯ä»¥åšä¸€åˆ‡ä½ åœ¨ numpy ä¸Šèƒ½åšçš„äº‹æƒ…ï¼æˆ‘ä»¬æš‚ä¸”ç§°å®ƒä¸º â€œå…¨èƒ½çš„ numpyâ€ ã€‚</p>

<p><strong>ä½¿ç”¨ TensorFlow çš„ä¼˜ç‚¹æ˜¯ï¼š</strong></p>

<ul>
  <li><strong>å®ƒæœ‰ä¸€ä¸ªç›´è§‚çš„ç»“æ„</strong>Â ï¼Œé¡¾åæ€ä¹‰å®ƒæœ‰Â â€œå¼ é‡æµâ€ï¼Œä½ å¯ä»¥è½»æ¾åœ°å¯è§†æ¯ä¸ªå›¾ä¸­çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ã€‚</li>
  <li><strong>è½»æ¾åœ°åœ¨ cpu / gpu ä¸Šè¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—</strong></li>
  <li><strong>å¹³å°çš„çµæ´»æ€§</strong> Â ã€‚å¯ä»¥éšæ—¶éšåœ°è¿è¡Œæ¨¡å‹ï¼Œæ— è®ºæ˜¯åœ¨ç§»åŠ¨ç«¯ã€æœåŠ¡å™¨è¿˜æ˜¯ PC ä¸Šã€‚</li>
</ul>

<h3 id="tensorflow-çš„å…¸å‹-æµ"><a name="A-typical-flow"></a>TensorFlow çš„å…¸å‹ â€œæµâ€</h3>

<p>ã€€ã€€æ¯ä¸ªåº“éƒ½æœ‰è‡ªå·±çš„â€œå®ç°ç»†èŠ‚â€ï¼Œå³ä¸€ç§å†™å…¶éµå¾ªå…¶ç¼–ç èŒƒä¾‹çš„æ–¹å¼ã€‚Â ä¾‹å¦‚ï¼Œå½“å®ç° scikit-learn æ—¶ï¼Œé¦–å…ˆåˆ›å»ºæ‰€éœ€ç®—æ³•çš„å¯¹è±¡ï¼Œç„¶ååœ¨è®­ç»ƒå’Œæµ‹è¯•é›†ä¸Šæ„å»ºä¸€ä¸ªæ¨¡å‹è·å¾—é¢„æµ‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c"># define hyperparamters of ML algorithm</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="c"># train </span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c"># test </span>
<span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre>
</div>

<p>æ­£å¦‚æˆ‘å‰é¢æ‰€è¯´ï¼ŒTensorFlow éµå¾ªä¸€ç§æ‡’æƒ°çš„æ–¹æ³•ã€‚Â åœ¨ TensorFlow ä¸­è¿è¡Œç¨‹åºçš„é€šå¸¸å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>

<ul>
  <li><strong>å»ºç«‹ä¸€ä¸ªè®¡ç®—å›¾</strong>ï¼ŒÂ ä»»ä½•çš„æ•°å­¦è¿ç®—å¯ä»¥ä½¿ç”¨ TensorFlow æ”¯æ’‘ã€‚</li>
  <li><strong>åˆå§‹åŒ–å˜é‡</strong>ï¼ŒÂ ç¼–è¯‘é¢„å…ˆå®šä¹‰çš„å˜é‡</li>
  <li><strong>åˆ›å»º session</strong>ï¼ŒÂ è¿™æ˜¯ç¥å¥‡çš„å¼€å§‹çš„åœ°æ–¹Â ï¼</li>
  <li><strong>åœ¨ session ä¸­è¿è¡Œå›¾</strong>ï¼ŒÂ ç¼–è¯‘å›¾å½¢è¢«ä¼ é€’åˆ° session ï¼Œå®ƒå¼€å§‹æ‰§è¡Œå®ƒã€‚</li>
  <li><strong>å…³é—­ session</strong>ï¼ŒÂ ç»“æŸè¿™æ¬¡ä½¿ç”¨ã€‚</li>
</ul>

<p>TensoFlow ä¸­ä½¿ç”¨çš„æœ¯è¯­å¾ˆå°‘</p>

<div class="highlighter-rouge"><pre class="highlight"><code>placeholderï¼šå°†æ•°æ®è¾“å…¥å›¾å½¢çš„ä¸€ç§æ–¹æ³•
feed_dictï¼šå°†æ•°å€¼ä¼ é€’åˆ°è®¡ç®—å›¾çš„å­—å…¸
</code></pre>
</div>

<p>è®©æˆ‘ä»¬å†™ä¸€ä¸ªå°ç¨‹åºæ¥æ·»åŠ ä¸¤ä¸ªæ•°å­—ï¼</p>

<pre><code class="language-pyhton">
# import tensorflow
import tensorflow as tf

# build computational graph
a = tf.placeholder(tf.int16)
b = tf.placeholder(tf.int16)

addition = tf.add(a, b)

# initialize variables
init = tf.initialize_all_variables()

# create session and run the graph
with tf.Session() as sess:
    sess.run(init)
    print "Addition: %i" % sess.run(addition, feed_dict={a: 2, b: 3})

# close session
sess.close()
</code></pre>

<h3 id="åœ¨-tensorflow-ä¸­å®ç°ç¥ç»ç½‘ç»œ"><a name="MLP"></a>åœ¨ TensorFlow ä¸­å®ç°ç¥ç»ç½‘ç»œ</h3>

<p><em>æ³¨æ„ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¥ç»ç½‘ç»œä½“ç³»ç»“æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åœ¨æ·±å…¥å®æ–½ä¸­è®¨è®º <code class="highlighter-rouge">å‰é¦ˆå¤šå±‚æ„ŸçŸ¥å™¨</code>ã€‚</em></p>

<p>è®©æˆ‘ä»¬è®°ä½å¯¹ç¥ç»ç½‘ç»œçš„äº†è§£ã€‚</p>

<p>ç¥ç»ç½‘ç»œçš„å…¸å‹å®ç°å¦‚ä¸‹ï¼š</p>

<ul>
  <li>å®šä¹‰è¦ç¼–è¯‘çš„ç¥ç»ç½‘ç»œä½“ç³»ç»“æ„</li>
  <li>å°†æ•°æ®ä¼ è¾“åˆ°æ¨¡å‹</li>
  <li>æ•´ä¸ªè¿è¡Œä¸­ï¼Œæ•°æ®é¦–å…ˆè¢«åˆ†æˆæ‰¹æ¬¡ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è¢«æ‘„å–ã€‚é¦–å…ˆå¯¹æ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼Œæ‰©å¢ï¼Œç„¶åé€å…¥ç¥ç»ç½‘ç»œè¿›è¡Œè®­ç»ƒ</li>
  <li>ç„¶åï¼Œæ¨¡å‹è¢«é€æ­¥åœ°è®­ç»ƒ</li>
  <li>æ˜¾ç¤ºç‰¹å®šæ•°é‡çš„æ—¶é—´æ­¥é•¿çš„ç²¾åº¦</li>
  <li>è®­ç»ƒåä¿å­˜æ¨¡å‹ä¾›å°†æ¥ä½¿ç”¨</li>
  <li>åœ¨æ–°æ•°æ®ä¸Šæµ‹è¯•æ¨¡å‹å¹¶æ£€æŸ¥å…¶è¿è¡Œæ–¹å¼</li>
</ul>

<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è§£å†³äº†æˆ‘ä»¬æ·±åˆ»çš„å­¦ä¹ å®è·µä¸­çš„é—®é¢˜ -Â [è¯†åˆ«æ•°å­—]ï¼Œè®©å†æˆ‘ä»¬èŠ±ä¸€ç‚¹æ—¶é—´çœ‹çœ‹é—®é¢˜é™ˆè¿°ã€‚</p>

<p>ã€€ã€€æˆ‘ä»¬çš„é—®é¢˜æ˜¯å›¾åƒè¯†åˆ«ï¼Œä»¥è¯†åˆ«æ¥è‡ªç»™å®šçš„ 28Ã—28 å›¾åƒçš„æ•°å­—ã€‚Â æˆ‘ä»¬æœ‰ä¸€ä¸ªå›¾åƒå­é›†ç”¨äºè®­ç»ƒï¼Œå…¶ä½™çš„ç”¨äºæµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹ã€‚é¦–å…ˆä¸‹è½½è®­ç»ƒå’Œæµ‹è¯•æ–‡ä»¶ã€‚æ•°æ®é›†åŒ…å«æ•°æ®é›†ä¸­æ‰€æœ‰å›¾åƒçš„å‹ç¼©æ–‡ä»¶ï¼Œ train.csv å’Œ test.csv éƒ½æœ‰ç›¸åº”çš„è®­ç»ƒå’Œæµ‹è¯•å›¾åƒçš„åç§°ã€‚æ•°æ®é›†ä¸­ä¸æä¾›ä»»ä½•å…¶ä»–åŠŸèƒ½ï¼Œåªæ˜¯åŸå§‹å›¾åƒä»¥ â€œ.pngâ€ æ ¼å¼æä¾›ã€‚</p>

<p>ã€€ã€€å¦‚ä¹‹å‰è¯´çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ TensorFlow æ¥åˆ›å»ºä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹ã€‚Â æ‰€ä»¥é¦–å…ˆåœ¨ä½ çš„ç³»ç»Ÿä¸­å®‰è£… TensorFlow ã€‚Â è¯·å‚è€ƒÂ <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/g3doc/get_started/os_setup.md">å®˜æ–¹çš„å®‰è£…æŒ‡å—</a>Â è¿›è¡Œå®‰è£…ï¼ŒæŒ‰æ‚¨çš„ç³»ç»Ÿè§„æ ¼ã€‚</p>

<p>æˆ‘ä»¬å°†æŒ‰ç…§ä¸Šè¿°æ¨¡æ¿</p>

<ul>
  <li>è®©æˆ‘ä»¬æ¥Â å¯¼å…¥æ‰€æœ‰éœ€è¦çš„æ¨¡å—</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

</code></pre>
</div>

<ul>
  <li>è®©æˆ‘ä»¬æ¥Â è®¾ç½®ä¸€ä¸ªç§å­å€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶æˆ‘ä»¬çš„æ¨¡å‹éšæœºæ€§</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c"># To stop potential randomness</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

</code></pre>
</div>

<ul>
  <li>ç¬¬ä¸€æ­¥æ˜¯è®¾ç½®ç›®å½•è·¯å¾„ï¼Œä»¥ä¾¿ä¿ç®¡ï¼</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s">'../..'</span><span class="p">)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="s">'data'</span><span class="p">)</span>
<span class="n">sub_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="s">'sub'</span><span class="p">)</span>

<span class="c"># check for existence</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sub_dir</span><span class="p">)</span>

</code></pre>
</div>

<ul>
  <li>ç°åœ¨è®©æˆ‘ä»¬è¯»å–æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œè¿™äº›æ˜¯ .csv æ ¼å¼ï¼Œå¹¶æœ‰ä¸€ä¸ªæ–‡ä»¶åä»¥åŠç›¸åº”çš„æ ‡ç­¾</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="err">ï¼Œ</span><span class="s">'Train'</span><span class="err">ï¼Œ</span><span class="s">'train.csv'</span><span class="p">))</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="err">ï¼ˆ</span><span class="n">data_dir</span><span class="err">ï¼Œ</span><span class="s">'Test.csv'</span><span class="p">))</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="err">ï¼Œ</span><span class="s">'Sample_Submission.csv'</span><span class="p">))</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

</code></pre>
</div>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th style="text-align: center">æ–‡ä»¶å</th>
      <th style="text-align: right">æ ‡ç­¾</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td style="text-align: center">0.png</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td>1</td>
      <td style="text-align: center">1.png</td>
      <td style="text-align: right">9</td>
    </tr>
    <tr>
      <td>2</td>
      <td style="text-align: center">2.png</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td>3</td>
      <td style="text-align: center">3.png</td>
      <td style="text-align: right">7</td>
    </tr>
    <tr>
      <td>4</td>
      <td style="text-align: center">4.png</td>
      <td style="text-align: right">3</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­ï¼æˆ‘ä»¬è¯»å–æˆ‘ä»¬çš„å½¢è±¡å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">img_name</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'Train'</span><span class="p">,</span> <span class="s">'Images'</span><span class="p">,</span> <span class="s">'train'</span><span class="p">,</span> <span class="n">img_name</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre>
</div>

<p><img src="https://www.analyticsvidhya.com/wp-content/uploads/2016/10/3.png" alt="" /></p>

<p>ä¸Šé¢çš„å›¾åƒè¡¨ç¤ºä¸º numpy æ•°ç»„ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>

<p><img src="https://www.analyticsvidhya.com/wp-content/uploads/2016/10/one.png" alt="" /></p>

<ul>
  <li>ä¸ºäº†æ–¹ä¾¿æ•°æ®æ“ä½œï¼Œè®©æˆ‘ä»¬Â çš„å­˜å‚¨ä½œä¸º numpy çš„é˜µåˆ—çš„æ‰€æœ‰å›¾ç‰‡</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">img_name</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
    <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'Train'</span><span class="p">,</span> <span class="s">'Images'</span><span class="p">,</span> <span class="s">'train'</span><span class="p">,</span> <span class="n">img_name</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float32'</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    
<span class="n">train_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">img_name</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
    <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'Train'</span><span class="p">,</span> <span class="s">'Images'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">,</span> <span class="n">img_name</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float32'</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    
<span class="n">test_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</code></pre>
</div>

<ul>
  <li>ç”±äºè¿™æ˜¯å…¸å‹çš„ ML é—®é¢˜ï¼Œä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹çš„æ­£ç¡®åŠŸèƒ½ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéªŒè¯é›†ï¼Œè®©æˆ‘ä»¬ä»¥ 70:30 çš„åˆ†å‰²è®­ç»ƒé›† å’Œ éªŒè¯é›†</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">split_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">train_x</span><span class="p">,</span> <span class="n">val_x</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[:</span><span class="n">split_size</span><span class="p">],</span> <span class="n">train_x</span><span class="p">[</span><span class="n">split_size</span><span class="p">:]</span>
<span class="n">train_y</span><span class="p">,</span> <span class="n">val_y</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="n">split_size</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">split_size</span><span class="p">:]</span>

</code></pre>
</div>

<ul>
  <li>æˆ‘ä»¬å®šä¹‰ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œæˆ‘ä»¬ç¨ååœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ä½¿ç”¨</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">dense_to_one_hot</span><span class="p">(</span><span class="n">labels_dense</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="s">"""Convert class labels from scalars to one-hot vectors"""</span>
    <span class="n">num_labels</span> <span class="o">=</span> <span class="n">labels_dense</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">index_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_labels</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_classes</span>
    <span class="n">labels_one_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_labels</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">))</span>
    <span class="n">labels_one_hot</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">index_offset</span> <span class="o">+</span> <span class="n">labels_dense</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">labels_one_hot</span>

<span class="k">def</span> <span class="nf">preproc</span><span class="p">(</span><span class="n">unclean_batch_x</span><span class="p">):</span>
    <span class="s">"""Convert values to range 0-1"""</span>
    <span class="n">temp_batch</span> <span class="o">=</span> <span class="n">unclean_batch_x</span> <span class="o">/</span> <span class="n">unclean_batch_x</span><span class="o">.</span><span class="nb">max</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">temp_batch</span>

<span class="k">def</span> <span class="nf">batch_creator</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">dataset_length</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">):</span>
    <span class="s">"""Create batch with random samples and return appropriate format"""</span>
    <span class="n">batch_mask</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">dataset_length</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
    
    <span class="n">batch_x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s">'_x'</span><span class="p">)[[</span><span class="n">batch_mask</span><span class="p">]]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">784</span><span class="p">)</span>
    <span class="n">batch_x</span> <span class="o">=</span> <span class="n">preproc</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">dataset_name</span> <span class="o">==</span> <span class="s">'train'</span><span class="p">:</span>
        <span class="n">batch_y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">)</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">batch_mask</span><span class="p">,</span> <span class="s">'label'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">batch_y</span> <span class="o">=</span> <span class="n">dense_to_one_hot</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span>

</code></pre>
</div>

<ul>
  <li>ä¸»è¦éƒ¨åˆ†ï¼Â è®©æˆ‘ä»¬å®šä¹‰æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ¶æ„ã€‚Â æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç¥ç»ç½‘ç»œå…·æœ‰ 3 å±‚ï¼Œè¾“å…¥ã€éšè— å’Œ è¾“å‡ºï¼Œ è¾“å…¥å’Œè¾“å‡ºä¸­çš„ç¥ç»å…ƒæ•°ç›®æ˜¯å›ºå®šçš„ï¼Œå› ä¸ºè¾“å…¥æ˜¯æˆ‘ä»¬çš„ 28Ã—28 å›¾åƒï¼Œå¹¶ä¸”è¾“å‡ºæ˜¯è¡¨ç¤ºç±»çš„ 10Ã—1 å‘é‡ã€‚Â æˆ‘ä»¬åœ¨éšè—å±‚ä¸­å– 500 ç¥ç»å…ƒã€‚è¿™ä¸ªæ•°å­—å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦å˜åŒ–ã€‚æˆ‘ä»¬æŠŠå€¼Â èµ‹ç»™Â å…¶ä½™å˜é‡ã€‚Â å¯ä»¥é˜…è¯»Â <a href="https://www.analyticsvidhya.com/blog/2016/03/introduction-deep-learning-fundamentals-neural-networks/">ç¥ç»ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†çš„æ–‡ç« </a>Â ï¼Œä»¥æ›´æ·±çš„äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œã€‚</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="c">### set all variables</span>

<span class="c"># number of neurons in each layer</span>

<span class="n">input_num_units</span> <span class="o">=</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span>

<span class="n">hidden_num_units</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">output_num_units</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c"># define placeholders</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="n">input_num_units</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="n">output_num_units</span><span class="p">])</span>

<span class="c"># set remaining variables</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c">### define weights and biases of the neural network (refer this article if you don't understand the terminologies)</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'hidden'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">input_num_units</span><span class="p">,</span> <span class="n">hidden_num_units</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)),</span>
    <span class="s">'output'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">hidden_num_units</span><span class="p">,</span> <span class="n">output_num_units</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">biases</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'hidden'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">hidden_num_units</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)),</span>
    <span class="s">'output'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">output_num_units</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">))</span>
<span class="p">}</span>

</code></pre>
</div>

<ul>
  <li>ç°åœ¨åˆ›å»ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œè®¡ç®—å›¾</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s">'hidden'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s">'hidden'</span><span class="p">])</span>
<span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">)</span>

<span class="n">output_layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s">'output'</span><span class="p">])</span> <span class="o">+</span> <span class="n">biases</span><span class="p">[</span><span class="s">'output'</span><span class="p">]</span>

</code></pre>
</div>

<ul>
  <li>æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ç¥ç»ç½‘ç»œçš„æˆæœ¬</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">output_layer</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

</code></pre>
</div>

<ul>
  <li>è®¾ç½®ä¼˜åŒ–å™¨ï¼Œå³æˆ‘ä»¬çš„åå‘ä¼ æ’­ç®—æ³•ã€‚Â è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Â <a href="https://arxiv.org/abs/1412.6980">Adam</a>Â ï¼Œè¿™æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•çš„é«˜æ•ˆå˜ä½“ã€‚Â æœ‰åœ¨ tensorflow å¯ç”¨è®¸å¤šå…¶å®ƒä¼˜åŒ–ï¼ˆå‚ç…§Â <a href="https://www.tensorflow.org/versions/r0.11/api_docs/python/train.html#optimizers">æ­¤å¤„</a>Â ï¼‰</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

</code></pre>
</div>
<ul>
  <li>å®šä¹‰æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œç»“æ„åï¼Œè®©æˆ‘ä»¬æ¥Â åˆå§‹åŒ–æ‰€æœ‰çš„å˜é‡</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">initialize_all_variables</span><span class="p">()</span>

</code></pre>
</div>

<ul>
  <li>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Session ï¼Œå¹¶åœ¨ Session ä¸­è¿è¡Œæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬è¿˜éªŒè¯æˆ‘ä»¬åˆ›å»ºçš„éªŒè¯é›†çš„æ¨¡å‹å‡†ç¡®æ€§</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="c"># create initialized variables</span>
    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
    
    <span class="c">### for each epoch, do:</span>
    <span class="c">###   for each batch, do:</span>
    <span class="c">###     create pre-processed batch</span>
    <span class="c">###     run optimizer by feeding batch</span>
    <span class="c">###     find cost and reiterate to minimize</span>
    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="n">avg_cost</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_batch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_batch</span><span class="p">):</span>
            <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">batch_creator</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">'train'</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">cost</span><span class="p">],</span> <span class="n">feed_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">batch_y</span><span class="p">})</span>
            
            <span class="n">avg_cost</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">total_batch</span>
            
        <span class="k">print</span> <span class="s">"Epoch:"</span><span class="p">,</span> <span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s">"cost ="</span><span class="p">,</span> <span class="s">"{:.5f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_cost</span><span class="p">)</span>
    
    <span class="k">print</span> <span class="s">"</span><span class="se">\n</span><span class="s">Training complete!"</span>
    
    
    <span class="c"># find predictions on val set</span>
    <span class="n">pred_temp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output_layer</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pred_temp</span><span class="p">,</span> <span class="s">"float"</span><span class="p">))</span>
    <span class="k">print</span> <span class="s">"Validation Accuracy:"</span><span class="p">,</span> <span class="n">accuracy</span><span class="o">.</span><span class="nb">eval</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">val_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">784</span><span class="p">),</span> <span class="n">y</span><span class="p">:</span> <span class="n">dense_to_one_hot</span><span class="p">(</span><span class="n">val_y</span><span class="o">.</span><span class="n">values</span><span class="p">)})</span>
    
    <span class="n">predict</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output_layer</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">predict</span><span class="o">.</span><span class="nb">eval</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">test_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">784</span><span class="p">)})</span>
</code></pre>
</div>

<p>è¿™å°†æ˜¯ä¸Šé¢ä»£ç çš„è¾“å‡º</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">Epoch</span><span class="p">:</span> <span class="mi">1</span> <span class="n">cost</span> <span class="o">=</span> <span class="mf">8.93566</span>
<span class="n">Epoch</span><span class="p">:</span> <span class="mi">2</span> <span class="n">cost</span> <span class="o">=</span> <span class="mf">1.82103</span>
<span class="n">Epoch</span><span class="p">:</span> <span class="mi">3</span> <span class="n">cost</span> <span class="o">=</span> <span class="mf">0.98648</span>
<span class="n">Epoch</span><span class="p">:</span> <span class="mi">4</span> <span class="n">cost</span> <span class="o">=</span> <span class="mf">0.57141</span>
<span class="n">Epoch</span><span class="p">:</span> <span class="mi">5</span> <span class="n">cost</span> <span class="o">=</span> <span class="mf">0.44550</span>

<span class="n">Training</span> <span class="n">complete</span><span class="err">!</span>
<span class="n">Validation</span> <span class="n">Accuracy</span><span class="p">:</span> <span class="mf">0.952823</span>	

</code></pre>
</div>

<ul>
  <li>éªŒè¯æˆ‘ä»¬è‡ªå·±çš„çœ¼ç›ï¼Œè®©æˆ‘ä»¬æ¥Â æƒ³è±¡å®ƒçš„é¢„è¨€</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">img_name</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">'Train'</span><span class="p">,</span> <span class="s">'Images'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">,</span> <span class="n">img_name</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
 
<span class="n">test_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">49000</span>

<span class="k">print</span> <span class="s">"Prediction is: "</span><span class="p">,</span> <span class="n">pred</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">Prediction</span> <span class="ow">is</span><span class="p">:</span>  <span class="mi">8</span>

</code></pre>
</div>

<p><img src="https://www.analyticsvidhya.com/wp-content/uploads/2016/10/8.png" alt="" /></p>

<ul>
  <li>æˆ‘ä»¬çœ‹åˆ°çš„æ¨¡å‹æ€§èƒ½æ˜¯ç›¸å½“ä¸é”™ï¼Â ç°åœ¨è®©æˆ‘ä»¬Â åˆ›å»ºä¸€ä¸ªæäº¤</li>
</ul>

<div class="language-python highlighter-rouge"><pre class="highlight"><code>
<span class="n">sample_submission</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">filename</span>
 
<span class="n">sample_submission</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">pred</span>

<span class="n">sample_submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_dir</span><span class="p">,</span> <span class="s">'sub01.csv'</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

</code></pre>
</div>

<p>ã€€ã€€ç»ˆäºå®Œæˆäº†ï¼Â æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†è‡ªå·±çš„è®­ç»ƒç¥ç»ç½‘ç»œï¼</p>

<h3 id="tensorflow-çš„é™åˆ¶"><a name="Limitations-of-TensorFlow"></a>TensorFlow çš„é™åˆ¶</h3>

<ul>
  <li>å°½ç®¡ TensorFlow æ˜¯å¼ºå¤§çš„ï¼Œå®ƒä»ç„¶æ˜¯ä¸€ä¸ªä½æ°´å¹³åº“ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯ä»¥è¢«è®¤ä¸ºæ˜¯æœºå™¨çº§è¯­è¨€ï¼Œä½†å¯¹äºå¤§å¤šæ•°åŠŸèƒ½ï¼Œæ‚¨éœ€è¦è‡ªå·±å»æ¨¡å—åŒ–å’Œé«˜çº§æ¥å£ï¼Œå¦‚ keras</li>
  <li>å®ƒä»ç„¶åœ¨ç»§ç»­å¼€å‘å’Œç»´æŠ¤ï¼Œè¿™æ˜¯å¤šä¹ˆğŸ‘å•Šï¼</li>
  <li>å®ƒå–å†³äºä½ çš„ç¡¬ä»¶è§„æ ¼ï¼Œé…ç½®è¶Šé«˜è¶Šå¥½</li>
  <li>ä¸æ˜¯æ‰€æœ‰å˜æˆè¯­è¨€èƒ½ä½¿ç”¨å®ƒçš„ API ã€‚</li>
  <li>TensorFlow ä¸­ä»ç„¶æœ‰å¾ˆå¤šåº“éœ€è¦æ‰‹åŠ¨å¯¼å…¥ï¼Œæ¯”å¦‚ OpenCL æ”¯æŒã€‚</li>
</ul>

<p>ä¸Šé¢æåˆ°çš„å¤§å¤šæ•°æ˜¯åœ¨ TensorFlow å¼€å‘äººå‘˜çš„æ„¿æ™¯ï¼Œä»–ä»¬å·²ç»åˆ¶å®šäº†ä¸€ä¸ªè·¯çº¿å›¾ï¼Œè®¡åˆ’åº“æœªæ¥åº”è¯¥å¦‚ä½•å¼€å‘ã€‚</p>

<h3 id="tensorflow-ä¸å…¶ä»–åº“"><a name="vs-libraries"></a>TensorFlow ä¸å…¶ä»–åº“</h3>

<p>ã€€ã€€TensorFlow å»ºç«‹åœ¨ç±»ä¼¼çš„åŸç†ï¼Œå¦‚ä½¿ç”¨æ•°å­¦è®¡ç®—å›¾è¡¨çš„ Theano å’Œ Torchï¼Œä½†æ˜¯éšç€åˆ†å¸ƒå¼è®¡ç®—çš„é¢å¤–æ”¯æŒï¼ŒTensorFlow æ›´å¥½åœ°è§£å†³å¤æ‚çš„é—®é¢˜ã€‚Â æ­¤å¤–ï¼ŒTensorFlow æ¨¡å‹çš„éƒ¨ç½²å·²ç»è¢«æ”¯æŒï¼Œè¿™ä½¿å¾—å®ƒæ›´å®¹æ˜“ç”¨äºå·¥ä¸šç›®çš„ï¼Œæ‰“å¼€ä¸€äº›å•†ä¸šçš„ä¸‰æ–¹åº“ï¼Œå¦‚ Deeplearning4j ï¼ŒH2O å’Œ Turiã€‚Â TensorFlow æœ‰ç”¨äº Pythonï¼ŒC ++ å’Œ Matlab çš„ API ã€‚Â æœ€è¿‘è¿˜å‡ºç°äº†å¯¹ Ruby å’Œ R ç­‰å…¶ä»–è¯­è¨€çš„æ”¯æŒã€‚å› æ­¤ï¼ŒTensorFlow è¯•å›¾è·å¾—é€šç”¨è¯­è¨€æ”¯æŒã€‚</p>

<h3 id="ä»è¿™é‡Œå»å“ªé‡Œ"><a name="Where-to-go-from-here"></a>ä»è¿™é‡Œå»å“ªé‡Œï¼Ÿ</h3>

<p>ã€€ã€€ä»¥ä¸Šä½ çœ‹åˆ°äº†å¦‚ä½•ç”¨ TensorFlow æ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼Œè¿™æ®µä»£ç æ˜¯ä¸ºäº†è®©äººä»¬äº†è§£å¦‚ä½•å¼€å§‹å®ç° TensorFlowã€‚Â è¦è§£å†³æ›´å¤æ‚çš„ç°å®ç”Ÿæ´»ä¸­çš„é—®é¢˜ï¼Œä½ å¿…é¡»åœ¨è¿™ç¯‡æ–‡ç« çš„åŸºç¡€ä¸Šåœ¨è°ƒæ•´ä¸€äº›ä»£ç æ‰è¡Œã€‚</p>

<p>ã€€ã€€è®¸å¤šä¸Šè¿°åŠŸèƒ½å¯ä»¥è¢«æŠ½è±¡ä¸ºç»™å‡ºæ— ç¼çš„ç«¯åˆ°ç«¯å·¥ä½œæµï¼Œå¦‚æœä½ ä½¿ç”¨ scikit-learn ï¼Œä½ å¯èƒ½çŸ¥é“ä¸€ä¸ªé«˜çº§åº“å¦‚ä½•æŠ½è±¡â€œåº•å±‚â€å®ç°ï¼Œç»™ç»ˆç«¯ç”¨æˆ·ä¸€ä¸ªæ›´å®¹æ˜“çš„ç•Œé¢ã€‚å°½ç®¡ TensorFlow å·²ç»æå–äº†å¤§å¤šæ•°å®ç°ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ›´é«˜çº§çš„åº“ï¼Œå¦‚ TF-slim å’Œ TFlearnã€‚</p>

<h3 id="å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</h3>
<ul>
  <li><a href="https://github.com/tensorflow/tensorflow">TensorFlow å®˜æ–¹åº“</a></li>
  <li>Rajat Mongaï¼ˆTensorFlowæŠ€æœ¯è´Ÿè´£äººï¼‰Â <a href="https://youtu.be/wmw8Bbb_eIE">â€œTensorFlowä¸ºå¤§å®¶â€</a> Â çš„è§†é¢‘</li>
  <li><a href="https://github.com/jtoy/awesome-tensorflow/#github-projects">ä¸€ä¸ªä¸“ç”¨èµ„æºçš„ç­–åˆ’åˆ—è¡¨</a></li>
</ul>

<h3 id="å…³äºåŸæ–‡">å…³äºåŸæ–‡</h3>

<p>æ„Ÿè°¢åŸæ–‡ä½œè€… <a href="https://www.analyticsvidhya.com/blog/author/jalfaizy/">Faizan Shaikh</a> çš„åˆ†äº«ï¼Œ
è¿™ç¯‡æ–‡ç« æ˜¯åœ¨ <a href="https://www.analyticsvidhya.com/blog/2016/10/an-introduction-to-implementing-neural-networks-using-tensorflow/">An Introduction to Implementing Neural Networks using TensorFlow</a> çš„åŸºç¡€ä¸Šåšçš„ç¿»è¯‘å’Œå±€éƒ¨è°ƒæ•´ï¼Œå¦‚æœå‘ç°ç¿»è¯‘ä¸­æœ‰ä¸å¯¹æˆ–è€…æ­§ä¹‰çš„çš„åœ°æ–¹æ¬¢è¿åœ¨ä¸‹é¢è¯„è®ºé‡Œæé—®ï¼Œæˆ‘ä¼šåŠ ä»¥ä¿®æ­£ ã€‚</p>

<p><br />
è½¬è½½è¯·æ³¨æ˜ï¼š<a href="http://baixin">æ½˜æŸä¿¡çš„åšå®¢</a> Â» <a href="http://baixin.io/2016/11/neural_networks_using_TensorFlow/">ä½¿ç”¨ TensorFlow å®ç°ç¥ç»ç½‘ç»œ</a></p>


    </section>
</article>
<section>
    <div class="content-play">
        <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang" title="æ‰“èµï¼Œæ”¯æŒä¸€ä¸‹">æ‰“èµä¸€ä¸ªå‘—</a></p>
        <div class="hide_box-play"></div>
        <div class="shang_box-play">
            <a class="shang_close-play" href="javascript:void(0)" onclick="dashangToggle()" title="å…³é—­"><img src="/assets/images/payimg/close.jpg" alt="å–æ¶ˆ" /></a>
            <div class="shang_tit-play">
                <p>æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„!</p>
            </div>
            <div class="shang_payimg">
                <img src="/assets/images/payimg/alipayimg.jpg" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«" />
            </div>
            <div class="shang_payimg">
                <img src="/assets/images/payimg/weipayimg.jpg" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«" />
            </div>
            <div class="pay_explain">æ‰«ç æ‰“èµï¼Œä½ è¯´å¤šå°‘å°±å¤šå°‘</div>
            <div class="shang_payselect">
                <div class="pay_item checked" data-id="alipay">
                    <span class="pay_logo"><img src="/assets/images/payimg/alipay.jpg" alt="æ”¯ä»˜å®" /></span>
                </div>
                <div class="pay_item" data-id="weipay">
                    <span class="pay_logo"><img src="/assets/images/payimg/wechat.jpg" alt="å¾®ä¿¡" /></span>
                </div>
            </div>
            <div class="shang_info-play">
                <p>æ‰“å¼€<span id="shang_pay_txt">æ”¯ä»˜å®</span>æ‰«ä¸€æ‰«ï¼Œå³å¯è¿›è¡Œæ‰«ç æ‰“èµå“¦</p>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    function dashangToggle() {
        $(".hide_box-play").fadeToggle();
        $(".shang_box-play").fadeToggle();
    }
    </script>
    <div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"></div>
    <style type="text/css">
    .content-play {
        width: 80%;
        margin-top: 20px;
        margin-bottom: 10px;
        height: 40px;
    }

    .hide_box-play {
        z-index: 999;
        filter: alpha(opacity=50);
        background: #666;
        opacity: 0.5;
        -moz-opacity: 0.5;
        left: 0;
        top: 0;
        height: 99%;
        width: 100%;
        position: fixed;
        display: none;
    }

    .shang_box-play {
        width: 540px;
        height: 460px;
        padding: 10px;
        background-color: #fff;
        border-radius: 10px;
        position: fixed;
        z-index: 1000;
        left: 50%;
        top: 50%;
        margin-left: -280px;
        margin-top: -280px;
        border: 1px dotted #dedede;
        display: none;
        text-align: center;
    }

    .shang_box-play img {
        border: none;
        border-width: 0;
    }

    .dashang {
        display: block;
        width: 100px;
        margin: 5px auto;
        line-height: 25px;
        padding: 10px;
        background-color: #E74851;
        color: #fff;
        text-align: center;
        text-decoration: none;
        border-radius: 10px;
        font-weight: bold;
        font-size: 16px;
        transition: all 0.3s;
    }

    .dashang:hover {
        opacity: 0.8;
    }

    .shang_close-play {
        float: right;
        display: inline-block;
        margin-right: 10px;
        margin-top: 20px;
    }

    .shang_logo {
        display: block;
        text-align: center;
        margin: 20px auto;
    }

    .shang_tit-play {
        width: 100%;
        height: 75px;
        text-align: center;
        line-height: 66px;
        color: #a3a3a3;
        font-size: 16px;
        background: url('/images/payimg/cy-reward-title-bg.jpg');
        font-family: 'Microsoft YaHei';
        margin-top: 7px;
        margin-right: 2px;
    }

    .shang_tit-play p {
        color: #a3a3a3;
        text-align: center;
        font-size: 16px;
    }

    .shang_payimg {
        padding: 10px;
        /*border:6px solid #EA5F00;**/
        margin: 0 auto;
        border-radius: 3px;
        height: 140px;
        display: inline-block;
    }

    .shang_payimg img {
        display: inline-block;
        margin-right: 10px;
        text-align: center;
        width: 140px;
        height: 140px;
    }

    .pay_explain {
        text-align: center;
        margin: 10px auto;
        font-size: 12px;
        color: #545454;
    }

    .shang_payselect {
        text-align: center;
        margin: 0 auto;
        margin-top: 40px;
        cursor: pointer;
        height: 60px;
    }

    .shang_payselect .pay_item {
        display: inline-block;
    }

    .shang_info-play {
        clear: both;
    }

    .shang_info-play p,
    .shang_info-play a {
        color: #C3C3C3;
        text-align: center;
        font-size: 12px;
        text-decoration: none;
        line-height: 2em;
    }
    </style>
    <ul class="pager">
        
        <li class="previous">
            <a href="/2016/11/20/markdownTool.html" data-toggle="tooltip" data-placement="top" title="Markdownå·¥å…·é›†">ä¸‹ä¸€ç¯‡ï¼š  <span>Markdownå·¥å…·é›†</span>
            </a>
        </li>
         
        <li class="next">
            <a href="/2016/12/02/iOS_Dev_Note.html" data-toggle="tooltip" data-placement="top" title="iOSå¼€å‘ä¸­çš„å°é—®é¢˜è®°å½•">ä¸Šä¸€ç¯‡ï¼š  <span>iOSå¼€å‘ä¸­çš„å°é—®é¢˜è®°å½•</span>
            </a>
        </li>
        
    </ul>
</section>
<div id="gitmentContainer"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
    owner: 'algate',
    repo: 'algate.github.io',
    oauth: {
        client_id: '0b0d43a49adc0200ac23',
        client_secret: '82553f5ed0d11dc2792158cf476aa731664467ca'
    },
});
gitment.render('gitmentContainer');
</script>
<!-- ä¸‹è¾¹ä¸ºuyanè¯„è®ºç³»ç»Ÿ (jekyllå…ˆæ³¨é‡Šæ‰comments.html)-->
        </div>
    </section>
    <section class="footer">
    <footer style="position: relative;z-index: 4;color:#444;">
        <div class = "footer_div">
        <nav class="cover-navigation navigation--social">
          <ul class="navigation">

          <!-- 

          

          

          

          RSS
          <li class="navigation__item_social">
            <a href="/feed.xml" rel="author" title="RSS" target="_blank">
              <i class='social fa fa-rss fa-2x'></i>
              <span class="label">RSS</span>
            </a>
          </li>

           -->

          </ul>
        </nav>

        </div>

        <div class = "footer_div">
          <div style="text-align: center;">
          <!-- è®¿é—®ç»Ÿè®¡ -->
            <span id="busuanzi_container_site_pv">æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>

          </div>
          <p class="copyright text-muted">
            Copyright &copy; Algate's Blog 2015-2018 Theme by <a href="https://algate.github.io/">Algate</a> |
            <iframe
                style="margin-left: 2px; margin-bottom:-5px;"
                frameborder="0" scrolling="0" width="91px" height="20px"
                src="https://ghbtns.com/github-btn.html?user=algate&repo=algate.github.io&type=star&count=true" >
            </iframe>
          </p>
        <div>
    </footer>
</section>

    <script type="text/javascript">
    var sitenavOn = document.getElementsByClassName('sitenav-on')[0];
    sitenavOn.addEventListener('click',function(e){
        document.body.classList.add('sitenav-active');
        e.stopPropagation();
    },false);
    document.getElementsByClassName('sitenav-mask')[0].addEventListener('click',function(e){
        var str = document.body.classList;
        if(str && str[1] == 'sitenav-active'){
            document.body.classList.remove('sitenav-active');
        }
    })
</script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script type="text/javascript" src="/assets/js/main.js"></script>
<script type="text/javascript">
(function() {
    try {
        if (!google.doodle) google.doodle = {};
        var d = [
                [307, 48, 88, 89],
                [307, 48, 89, 89],
                [307, 48, 91, 89],
                [305, 49, 93, 89],
                [305, 50, 93, 88],
                [305, 50, 93, 88],
                [306, 52, 92, 86],
                [305, 53, 93, 84],
                [305, 54, 94, 83],
                [306, 54, 93, 83],
                [307, 54, 92, 83],
                [307, 54, 92, 83],
                [308, 54, 90, 83],
                [308, 54, 90, 83],
                [306, 53, 91, 84],
                [306, 53, 91, 84],
                [308, 53, 90, 84],
                [308, 53, 90, 84],
                [305, 53, 92, 84],
                [305, 52, 92, 85],
                [306, 52, 91, 85],
                [308, 51, 88, 87, 1],
                [308, 50, 88, 88],
                [308, 49, 88, 88],
                [307, 49, 89, 88],
                [307, 50, 89, 87],
                [308, 51, 89, 86],
                [307, 54, 90, 83],
                [307, 57, 90, 80],
                [306, 58, 92, 79],
                [306, 58, 92, 79],
                [305, 60, 92, 77],
                [302, 61, 95, 76],
                [302, 63, 95, 74],
                [302, 51, 96, 86],
                [302, 66, 98, 71],
                [304, 67, 96, 69],
                [301, 63, 96, 74],
                [301, 58, 93, 79],
                [291, 52, 94, 85],
                [288, 50, 71, 88],
                [285, 43, 76, 95],
                [285, 37, 70, 101],
                [281, 29, 55, 109],
                [278, 20, 58, 119],
                [278, 20, 55, 119, 1],
                [277, 12, 121, 127],
                [271, 2, 122, 138],
                [267, 1, 126, 139],
                [264, 0, 136, 140],
                [260, 0, 141, 140],
                [255, 0, 148, 140],
                [252, 0, 151, 140],
                [249, 2, 121, 138],
                [247, 3, 123, 137],
                [246, 3, 123, 137],
                [246, 2, 124, 137],
                [258, 2, 112, 137],
                [263, 2, 106, 137],
                [263, 2, 106, 137],
                [262, 2, 103, 137],
                [260, 2, 104, 136],
                [260, 2, 104, 137, 1],
                [268, 2, 98, 137],
                [267, 2, 99, 137],
                [266, 2, 97, 137],
                [266, 3, 96, 136],
                [264, 3, 99, 136],
                [263, 3, 100, 136],
                [261, 3, 100, 136],
                [259, 2, 138, 137],
                [254, 2, 126, 137],
                [247, 2, 101, 136],
                [240, 2, 108, 136],
                [238, 1, 110, 137],
                [230, 1, 118, 138],
                [220, 15, 128, 124],
                [211, 18, 137, 121],
                [205, 43, 102, 96],
                [202, 45, 104, 93],
                [200, 38, 97, 101],
                [198, 38, 104, 101, 1],
                [197, 39, 107, 100],
                [197, 39, 112, 100],
                [213, 39, 94, 110],
                [212, 40, 95, 111],
                [211, 41, 97, 111],
                [209, 42, 99, 112],
                [209, 43, 98, 112],
                [213, 43, 87, 112],
                [213, 42, 83, 113],
                [211, 40, 86, 109],
                [211, 38, 86, 103],
                [211, 37, 88, 112],
                [211, 20, 186, 131],
                [213, 27, 167, 122],
                [212, 44, 87, 105],
                [210, 44, 88, 98],
                [195, 44, 106, 98],
                [189, 44, 110, 98],
                [182, 46, 117, 99],
                [173, 44, 118, 96, 1],
                [161, 43, 130, 99],
                [154, 42, 137, 97],
                [153, 42, 137, 97],
                [153, 42, 137, 97],
                [152, 41, 137, 98],
                [151, 41, 137, 97],
                [149, 41, 145, 97],
                [148, 25, 144, 114],
                [148, 13, 144, 126],
                [141, 12, 153, 127],
                [115, 11, 173, 128],
                [108, 7, 180, 133],
                [108, 4, 180, 136],
                [108, 3, 176, 137, 1],
                [108, 1, 161, 139],
                [105, 1, 235, 138],
                [103, 1, 295, 148],
                [103, 0, 277, 149],
                [108, 0, 234, 137],
                [101, 0, 232, 137],
                [99, 0, 135, 139],
                [95, 0, 244, 139],
                [81, 0, 152, 139],
                [69, 0, 164, 139, 1],
                [66, 0, 169, 139],
                [65, 0, 170, 139],
                [63, 0, 168, 138],
                [61, 0, 159, 138],
                [35, 0, 304, 139],
                [19, 0, 189, 140],
                [18, 11, 138, 129],
                [18, 11, 137, 129],
                [18, 11, 137, 128],
                [18, 6, 135, 133],
                [7, 4, 146, 136],
                [6, 4, 147, 136],
                [3, 4, 150, 136, 1],
                [3, 5, 150, 135],
                [3, 8, 150, 132],
                [4, 6, 394, 145],
                [12, 6, 388, 145],
                [11, 8, 389, 144],
                [11, 8, 387, 144],
                [11, 8, 387, 143, 1],
                [10, 8, 113, 131],
                [11, 8, 111, 131],
                [10, 9, 112, 130],
                [12, 9, 116, 130],
                [12, 9, 111, 130],
                [12, 9, 111, 130],
                [12, 9, 110, 131],
                [12, 34, 113, 106],
                [13, 35, 110, 104]
            ],
            e = d.length,
            f, g, h, i, j = -1,
            k = function() {
                google.nav && google.nav.go ? google.nav.go("http://www.google.com.hk//search?q=%E7%8E%9B%E8%8E%8E%C2%B7%E8%91%9B%E5%85%B0%E5%A7%86&ct=graham11-hp&oi=ddle&hl=zh-CN") : window.location.href = "http://www.google.com.hk//search?q=%E7%8E%9B%E8%8E%8E%C2%B7%E8%91%9B%E5%85%B0%E5%A7%86&ct=graham11-hp&oi=ddle&hl=zh-CN"
            },
            l = function() {
                var a = d[f],
                    c = document.getElementById("hplogo");
                if (c && a[0]) {
                    var b = document.createElement("div");
                    b.id = "hplogo" + f;
                    b.style.left = a[0] + "px";
                    b.style.top = a[1] + "px";
                    b.style.width = a[2] + "px";
                    b.style.height = a[3] + "px";
                    b.style.background = "url(/assets/images/graham11-hp-sprite.png) no-repeat " + -g + "px " + -h + "px";
                    b.onmousedown = k;
                    a[3] > i && (i = a[3]);
                    a[4] ? (g = 0, h += i, i = 0) : g += a[2];
                    c.appendChild(b);
                    ++f;
                    f < e && (j = window.setTimeout(l, 83))
                }
            },
            m = function() {
                google.doodle.a = !1;
                i = h = g = f = 0;
                j != -1 && (window.clearTimeout(j), j = -1);
                for (var a = 0; a < e; ++a) {
                    var c = document.getElementById("hplogo" + a);
                    c && c.parentNode && c.parentNode.removeChild(c)
                }
                j = window.setTimeout(l, 83)
            };
        if (!google.doodle.a) {
            google.doodle.a = !0;
            var n = document.createElement("img");
            n.addEventListener ? n.addEventListener("load", m, !1) : n.attachEvent("onload", m);
            n.src = "/assets/images/graham11-hp-sprite.png"
        }
    } catch (o) {
        google.ml(o, !1, {
            cause: "DOODLE"
        })
    };
})();
</script>



</body>

</html>